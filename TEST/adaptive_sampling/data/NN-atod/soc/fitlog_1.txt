Input argpars: {'index': '1', 'filepath': '/scratch/lijingbai2009/test/pmd2/neural_network/NN-egs/soc', 'gpus': '-1', 'mode': 'training'}
Warning: No devices found
Warning: Can not set GPU
Logic Devices: []
Training Model:  /scratch/lijingbai2009/test/pmd2/neural_network/NN-egs/soc
Network instance:  1
Found x-shape of (200, 18, 3)
Found energy-shape of (4,)
Info: Train-Test split at Train: 180 Test 20 Total 200
Info: Making new initialized weights.
Info: Total-Data energy std [200   4] : [24.68026986 20.21011249 16.72459937 15.37775912]
Info: Using energy-std (1, 4) : [[24.68026986 20.21011249 16.72459937 15.37775912]]
Info: Using energy-mean (1, 4) : [[19.25963915 44.25333702 22.76861256 13.34647043]]
Info: Using x-scale (1, 1, 1) : [[[1.]]]
Info: Using x-offset (1, 1, 1) : [[[0.]]]
Info: Using feature-scale (1, 153) : [[0.02204962 0.01878427 0.01000707 0.02912501 0.02093642 0.01569938
  0.01088542 0.0216098  0.01824092 0.01307993 0.01500799 0.01194795
  0.02689321 0.03959437 0.02191746 0.01265658 0.02088429 0.0187419
  0.01543123 0.07104871 0.02250657 0.06737021 0.01912733 0.02268852
  0.0132377  0.01072042 0.00859639 0.01135176 0.01873708 0.04950666
  0.011743   0.01576618 0.01653332 0.0118452  0.02172766 0.02845201
  0.02464076 0.01195144 0.07652799 0.00919033 0.01960289 0.01552248
  0.02691402 0.02448062 0.01365418 0.01133699 0.01539069 0.0067568
  0.06111941 0.00811214 0.021456   0.00795737 0.00883243 0.02114511
  0.00575228 0.00815724 0.00872262 0.01400999 0.02074626 0.0174544
  0.06152356 0.01787747 0.00582302 0.00669099 0.01242591 0.02127277
  0.02558225 0.02722405 0.01268615 0.10100663 0.01554155 0.04102452
  0.0088447  0.02095464 0.01236728 0.01633803 0.04510409 0.02225004
  0.01931827 0.01301338 0.00757292 0.04610104 0.0082151  0.0216015
  0.00617487 0.01797102 0.00833478 0.00907696 0.03470574 0.01437193
  0.05694735 0.01449748 0.0147923  0.02270001 0.04048746 0.02700706
  0.09948077 0.01411944 0.01444861 0.00785767 0.02256068 0.02078978
  0.05005397 0.04065421 0.01771194 0.00442581 0.00445405 0.00780852
  0.01410994 0.00784838 0.03811176 0.00755171 0.00776738 0.00346527
  0.01623758 0.01007078 0.03195995 0.00849186 0.01148619 0.01910151
  0.00383841 0.00424906 0.0087543  0.00639093 0.00776578 0.01758186
  0.00795983 0.00707021 0.00356997 0.02114787 0.00654303 0.01866341
  0.00646115 0.00648147 0.01174604 0.03411974 0.00655058 0.00535091
  0.00665111 0.01614177 0.00698117 0.03249453 0.00677912 0.00728577
  0.00395384 0.00931511 0.01395646 0.03159937 0.01317199 0.02055521
  0.01788736 0.06350259 0.03262123]]
Info: Using feature-offset (1, 153) : [[0.6388973  0.62360567 0.44830287 0.41758397 0.65735227 0.3504861
  0.44418415 0.62464243 0.63719743 0.46409264 0.34994698 0.46070707
  0.41333762 0.6743419  0.64805    0.31532106 0.41683495 0.42783538
  0.32572865 0.9018753  0.4278893  0.9061285  0.42892238 0.4196623
  0.29847297 0.31607    0.25429773 0.25504327 0.43553275 0.9084349
  0.32062176 0.43071693 0.41749817 0.3225483  0.3531273  0.37724936
  0.42067155 0.31717768 0.913396   0.25476745 0.42339092 0.2961404
  0.36398235 0.3576832  0.25805867 0.30937088 0.42178068 0.25710022
  0.9073977  0.31289256 0.43197852 0.24720846 0.24597631 0.3473468
  0.20144083 0.25812444 0.31231138 0.30999285 0.42818183 0.42342862
  0.9238231  0.34887913 0.20178515 0.24544173 0.24648535 0.3457743
  0.65990806 0.41667145 0.46071234 0.46836418 0.3499381  0.37752315
  0.25366515 0.43587512 0.29958442 0.3287704  0.3557174  0.28665197
  0.4184687  0.30622002 0.31054336 0.35304496 0.25605136 0.28587466
  0.2000514  0.34736645 0.24446459 0.24919501 0.3216926  0.2369132
  0.89573705 0.46550223 0.35172927 0.64802915 0.3773762  0.41537344
  0.469477   0.29650423 0.32778576 0.25592017 0.4362702  0.28612012
  0.360088   0.6766802  0.4325053  0.28366628 0.23532507 0.37120166
  0.2589879  0.27925593 0.31941855 0.2279934  0.23165709 0.18778011
  0.3275678  0.21910268 0.3022191  0.37821624 0.32371014 0.6909823
  0.23279107 0.20002285 0.32055312 0.20928946 0.24821146 0.2611159
  0.21710464 0.19934049 0.16544184 0.32200155 0.17966081 0.25982547
  0.27054265 0.23665693 0.42238045 0.81707007 0.2395958  0.20508485
  0.27406436 0.2373831  0.2262586  0.2725248  0.18894616 0.20231685
  0.16799441 0.24342927 0.21325241 0.2690262  0.3364328  0.32862774
  0.45589    0.89040184 0.49747553]]
Model: "energy_model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
feat_geo (FeatureGeometric)  multiple                  306       
_________________________________________________________________
feat_std (ConstLayerNormaliz multiple                  306       
_________________________________________________________________
mlp (MLP)                    multiple                  30800     
_________________________________________________________________
energy (Dense)               multiple                  804       
=================================================================
Total params: 32,216
Trainable params: 31,604
Non-trainable params: 612
_________________________________________________________________

Start fit.
Epoch 1/20
3/3 - 0s - loss: 2.6235 - mean_absolute_error: 23.3141 - lr: 0.0010 - r2_metric: -1.6748e+00
Epoch 2/20
3/3 - 0s - loss: 1.5042 - mean_absolute_error: 17.7221 - lr: 0.0010 - r2_metric: -5.4709e-01
Epoch 3/20
3/3 - 0s - loss: 0.9696 - mean_absolute_error: 14.6034 - lr: 0.0010 - r2_metric: -1.0686e-02
Epoch 4/20
3/3 - 0s - loss: 0.7365 - mean_absolute_error: 12.8880 - lr: 0.0010 - r2_metric: 0.2435
Epoch 5/20
3/3 - 0s - loss: 0.6391 - mean_absolute_error: 11.7474 - lr: 0.0010 - r2_metric: 0.3442
Epoch 6/20
3/3 - 0s - loss: 0.6282 - mean_absolute_error: 11.3870 - lr: 0.0010 - r2_metric: 0.3603
Epoch 7/20
3/3 - 0s - loss: 0.6102 - mean_absolute_error: 11.0673 - lr: 1.0000e-04 - r2_metric: 0.3724
Epoch 8/20
3/3 - 0s - loss: 0.6045 - mean_absolute_error: 11.0110 - lr: 1.0000e-04 - r2_metric: 0.3780
Epoch 9/20
3/3 - 0s - loss: 0.5948 - mean_absolute_error: 10.9135 - lr: 1.0000e-04 - r2_metric: 0.3974
Epoch 10/20
3/3 - 0s - loss: 0.5839 - mean_absolute_error: 10.8135 - lr: 1.0000e-04 - r2_metric: 0.3940 - val_loss: 0.8284 - val_mean_absolute_error: 12.6092 - val_lr: 1.0000e-04 - val_r2_metric: 0.3227
Epoch 11/20
3/3 - 0s - loss: 0.5710 - mean_absolute_error: 10.6913 - lr: 1.0000e-04 - r2_metric: 0.4098
Epoch 12/20
3/3 - 0s - loss: 0.5625 - mean_absolute_error: 10.6106 - lr: 1.0000e-05 - r2_metric: 0.4261
Epoch 13/20
3/3 - 0s - loss: 0.5612 - mean_absolute_error: 10.5996 - lr: 1.0000e-05 - r2_metric: 0.4186
Epoch 14/20
3/3 - 0s - loss: 0.5599 - mean_absolute_error: 10.5883 - lr: 1.0000e-05 - r2_metric: 0.4244
Epoch 15/20
3/3 - 0s - loss: 0.5586 - mean_absolute_error: 10.5768 - lr: 1.0000e-05 - r2_metric: 0.4302
Epoch 16/20
3/3 - 0s - loss: 0.5572 - mean_absolute_error: 10.5643 - lr: 1.0000e-05 - r2_metric: 0.4307
Epoch 17/20
3/3 - 0s - loss: 0.5560 - mean_absolute_error: 10.5529 - lr: 1.0000e-05 - r2_metric: 0.4225
Epoch 18/20
3/3 - 0s - loss: 0.5546 - mean_absolute_error: 10.5410 - lr: 1.0000e-05 - r2_metric: 0.4372
Epoch 19/20
3/3 - 0s - loss: 0.5532 - mean_absolute_error: 10.5286 - lr: 1.0000e-05 - r2_metric: 0.4330
Epoch 20/20
3/3 - 0s - loss: 0.5518 - mean_absolute_error: 10.5164 - lr: 1.0000e-05 - r2_metric: 0.4356 - val_loss: 0.8003 - val_mean_absolute_error: 12.3942 - val_lr: 1.0000e-05 - val_r2_metric: 0.3457
End fit.

Info: Saving auto-scaler to file...
Info: Predicted Energy shape: (180, 4)
Info: Predicted Gradient shape: (180, 4)
Info: Plot fit stats...
Info: Max error between precomputed and direct gradient:
Energy 6.023082882222752e-06
error_val: 12.394207490719186
error_train: 10.50714087170025
